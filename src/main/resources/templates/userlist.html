<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="utf-8" />
<title>ユーザー一覧</title>
<link href="stylesheets/common.css" rel="stylesheet" />
<link href="stylesheets/bootstrap.css" rel="stylesheet" />
<link href="stylesheets/jquery.bootgrid.css" rel="stylesheet" />
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.js"></script>
<script src="javascript/jquery.bootgrid.js"></script>
</head>
<body>
	
		<table id="grid-basic" class="table table-condensed table-hover table-striped">
				<thead>
					<tr>
					   <th data-column-id="no" data-type="numeric" data-identifier="true" data-width="3%">No</th>
		               <th data-column-id="custid" data-width="7%">ユーザーID</th>
		               <th data-column-id="custname"  data-width="10%">ユーザー名</th>
		               <th data-column-id="orgname"  data-width="40%">組織名</th>
		               <th data-column-id="password"  data-width="40%">パスワード</th>
		               <th data-column-id="effect"  data-width="40%">EFFECT</th>
		               <th data-column-id="role"  data-width="40%">役割</th>
		           </tr>
				</thead>
				
				<tbody>
					<tr th:each="user :${users}">
						<td th:text="${user.no}"></td>
						<td th:text="${user.custid}"></td>
						<td th:text="${user.custname}"></td>
						<td th:text="${user.orgname}"></td>
						<td th:text="${user.password}"></td>
						<td th:text="${user.effect}"></td>
						<td th:text="${user.role}"></td>
					</tr>
				</tbody>
		</table>
		
<script>
	var rowIds = [];
	$(function() {
		$("#grid-basic").bootgrid({
			selection: true,
			multiSelect: true,
			rowSelect: true,
		    keepSelection: true
		}).on("selected.rs.jquery.bootgrid", function(e, rows)
		{
		    for (var i = 0; i < rows.length; i++)
		    {
		        rowIds.push(rows[i].no);
		    }
		}).on("deselected.rs.jquery.bootgrid", function(e, rows)
		{
		    for (var i = 0; i < rows.length; i++)
		    {
		    	rowIds.some(function(v, ii){
		    	    if (v==rows[i].no) rowIds.splice(ii,1);
		    	});
		    }
		});
	});
	
	function drow() {
		if(rowIds.length == 0){
			alert("削除対象を選択してください");
			return;
		}
		var successFlg = true;
		var myRet = confirm("選択行を削除しますか？");
		if ( myRet == true ){
			for (var i = 0; i < rowIds.length; i++){
				$.ajax({
					type: "POST",
					url: "UserlistController.java",//削除するコントローラーを指定
					data: "no=" + rowIds[i],
				}).then(
						function(){
						},
						function(){
							successFlg = false;
						}
				);
			}
			if( successFlg == true){
				alert("削除しました");
				location.reload();
			}else{
				alert("削除できませんでした");
			}
			
		}
	}
</script>
</body>
</html>		