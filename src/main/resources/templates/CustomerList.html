<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8" />
<title>ユーザー一覧</title>

<link href="stylesheets/bootstrap.css" rel="stylesheet" />
<link href="stylesheets/jquery.bootgrid.css" rel="stylesheet" />

</head>
<body>

		<table id="grid-basic" class="table table-condensed table-hover table-striped">
				<thead>
					<tr>
					   
					   <th data-column-id="no" data-type="numeric" data-identifier="true" data-width="3%">No</th>
		               <th data-column-id="custid" data-width="7%">ユーザーID</th>
		               <th data-column-id="custname"  data-width="10%">ユーザー名</th>
		               <th data-column-id="orgname"  data-width="20%">組織名</th>
		               <th data-column-id="effect"  data-width="10%">EFFECT</th>
		               <th data-column-id="role"  data-width="7%">役割</th>
		           </tr>
				</thead>
				
				<tbody>
					
					<tr th:each="custinfoEntity :${custinfoEntity}">
						
						<td th:text="${custinfoEntity.no}"></td>
						<td th:text="${custinfoEntity.custid}"></td>
						<td th:text="${custinfoEntity.custname}"></td>
						<td th:text="${custinfoEntity.orgname}"></td>
						<td th:text="${custinfoEntity.effect}"></td>
						<td th:text="${custinfoEntity.role}"></td>
					</tr>
				</tbody>
		</table>	


<input id="btn_del"  value="選択行の削除" onclick="drow()">



<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.js"></script>
<script src="javascript/bootstrap.js"></script>
<script src="javascript/jquery.bootgrid.js"></script>
<script>

var rowIds = [];

$(function() {
	$('#grid-basic').bootgrid({
		selection: true,
		multiSelect: true,
		rowSelect: true,
	    keepSelection: true,
	})
	
	
	.on("selected.rs.jquery.bootgrid", function(e, rows)
			{
			    for (var i = 0; i < rows.length; i++)
			    {
			        rowIds.push(rows[i].no);
			    }
			}).on("deselected.rs.jquery.bootgrid", function(e, rows)
			{
			    for (var i = 0; i < rows.length; i++)
			    {
			    	rowIds.some(function(v, ii){
			    	    if (v==rows[i].no) rowIds.splice(ii,1);
			    	});
			        
			    }
			});
	
});



function drow() {
	if(rowIds.length == 0){
		alert("削除対象を選択してください");
		return;
	}
	var successFlg = true;
	var myRet = confirm("選択行を削除しますか？");
	
	if ( myRet == true ){
		for (var i = 0; i < rowIds.length; i++){
			
			
			$.ajax({
				type: "POST",
				url: "UserlistController.java",//削除するコントローラーを指定
				data: "no=" + rowIds[i],
			})
			
			
			.then(
					function(){
					},
					function(){
						successFlg = false;
					}
			);
		}
		if( successFlg == true){
			alert("削除しました");
			location.reload();
		}else{
			alert("削除できませんでした");
		}
		
	}
}


</script>
</body>
</html>		
